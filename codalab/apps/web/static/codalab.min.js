(function(c,g,h){var b=c(document);h=g.Modernizr;c(document).ready(function(){c.fn.foundationAlerts&&b.foundationAlerts();c.fn.foundationButtons&&b.foundationButtons();c.fn.foundationAccordion&&b.foundationAccordion();c.fn.foundationNavigation&&b.foundationNavigation();c.fn.foundationTopBar&&b.foundationTopBar();c.fn.foundationCustomForms&&b.foundationCustomForms();c.fn.foundationMediaQueryViewer&&b.foundationMediaQueryViewer();c.fn.foundationTabs&&b.foundationTabs({callback:c.foundation.customForms.appendCustomMarkup});
c.fn.foundationTooltips&&b.foundationTooltips();c.fn.foundationMagellan&&b.foundationMagellan();c.fn.foundationClearing&&b.foundationClearing();c.fn.placeholder&&c("input, textarea").placeholder()});h.touch&&!g.location.hash&&c(g).load(function(){setTimeout(function(){g.scrollTo(0,1)},0)})})(jQuery,this);var Competition;
(function(c){function g(b,a){0<$("#disallow_leaderboard_modifying").length?b.text("Leaderboard modifying disallowed").attr("disabled","disabled"):a?(b.removeClass("leaderBoardSubmit"),b.addClass("leaderBoardRemove"),b.text("Remove from Leaderboard")):(b.removeClass("leaderBoardRemove"),b.addClass("leaderBoardSubmit"),b.text("Submit to Leaderboard"))}function h(b,a,d,e){b="/api/competition/"+b+"/submission/"+a+"/leaderboard";var f="";e.hasClass("leaderBoardSubmit")?f="post":e.hasClass("leaderBoardRemove")&&(f=
"delete");request=$.ajax({url:b,type:f,datatype:"text",data:{csrfmiddlewaretoken:d},success:function(b,d,c){(b="post"==f)?(d=$("#user_results td.status"),d.removeClass("submitted"),d.addClass("not_submitted"),d.html(""),d=$("#"+a+" td.status"),d.addClass("submitted"),d.html('<span class="glyphicon glyphicon-ok"></span>'),$("#user_results .leaderboard_button.leaderBoardRemove").each(function(a){g($(this),!1)})):(d=$("#"+a+" td.status"),d.removeClass("submitted"),d.addClass("not_submitted"),d.html(""));
g(e,b)},error:function(a,b,d){alert("An error occurred. Please try again or report the issue")},beforeSend:function(a){a.setRequestHeader("X-CSRFToken",d)}})}c.getPhaseSubmissions=function(b,a,d){$(".competition_submissions").html("").append("<div class='competitionPreloader'></div>").children().css({top:"200px",display:"block"});$.ajax({type:"GET",url:"/competitions/"+b+"/submissions/"+a,cache:!1,success:function(a){$(".competition_submissions").html("").append(a);!1===CodaLab.FileUploader.isSupported()?
($("#fileUploadButton").addClass("disabled"),$("#details").html("Sorry, your browser does not support the HTML5 File API. Please use a newer browser.")):new CodaLab.FileUploader({buttonId:"fileUploadButton",sasEndpoint:"/api/competition/"+b+"/submission/sas",allowedFileTypes:["application/zip","application/x-zip-compressed"],maxFileSizeInBytes:1073741824,validateBeforeFilePrompt:function(){if(0==$("#submission_method_name").length)return!0;var a=$("#submission_team_name").val(),b=$("#submission_method_name").val(),
d=$("#submission_method_description").val();return a&&""!==a&&b&&""!==b&&d&&""!==d},beforeSelection:function(a,b){$("#fileUploadButton").addClass("disabled")},afterSelection:function(a,b){!1===b&&(0<a.files.length&&("type-error"===a.files[0].errors[0].kind?$("#details").html("Please select a valid file. Only ZIP files are accepted."):$("#details").html("The files that you selected is too large. There is a 1GB size limit.")),$("#fileUploadButton").removeClass("disabled"))},uploadProgress:function(a,
b,d){b=100*b/d;$("#details").html("Uploading file <em>"+a.name+"</em>: "+b.toFixed(0)+"% complete.")},uploadError:function(a){$("#details").html("There was an error uploading the file. Please try again.");$("#fileUploadButton").removeClass("disabled")},uploadSuccess:function(a,d){$("#details").html("Creating new submission...");var e=$("#submission_description_textarea").val()||"",l=$("#submission_method_name").val()||"",h=$("#submission_method_description").val()||"",g=$("#submission_project_url").val()||
"",n=$("#submission_publication_url").val()||"",p=$("#submission_bibtex").val()||"",q=$("#submission_team_name").val()||"",r=$("#submission_organization_or_affiliation").val()||"",t=$("#submission_phase_id").val();$("#submission_description_textarea").val("");$.ajax({url:"/api/competition/"+b+"/submission?description="+encodeURIComponent(e)+"&method_name="+encodeURIComponent(l)+"&method_description="+encodeURIComponent(h)+"&project_url="+encodeURIComponent(g)+"&publication_url="+encodeURIComponent(n)+
"&team_name="+encodeURIComponent(q)+"&organization_or_affiliation="+encodeURIComponent(r)+"&bibtex="+encodeURIComponent(p)+"&phase_id="+encodeURIComponent(t),type:"post",cache:!1,data:{id:d,name:a.name,type:a.type,size:a.size}}).done(function(a){$("#details").html("");$("#user_results tr.noData").remove();$("#user_results").append(c.displayNewSubmission(a,e,l,h,g,n,p,q,r));$("#user_results #"+a.id+" .glyphicon-plus").on("click",function(){c.showOrHideSubmissionDetails(this)});$("#fileUploadButton").removeClass("disabled");
$("#user_results #"+a.id+" .glyphicon-plus").click()}).fail(function(a){var b="An unexpected error occurred.";403==a.status&&(b=a.responseJSON.detail);$("#details").html(b);$("#fileUploadButton").removeClass("disabled")})}});$("#user_results .glyphicon-plus").on("click",function(){c.showOrHideSubmissionDetails(this)})},error:function(a,b,d){$(".competition_submissions").html("<div class='alert alert-error'>An error occurred. Please try refreshing the page.</div>")}})};c.getPhaseResults=function(b,
a){$(".competition_results").html("").append("<div class='competitionPreloader'></div>").children().css({top:"200px",display:"block"});$.ajax({type:"GET",url:"/competitions/"+b+"/results/"+a,cache:!1,success:function(a){$(".competition_results").html("").append(a);$(".column-selectable").click(function(a){a=$(this).closest("table");$(a).find(".column-selected").removeClass();$(this).addClass("column-selected");var b=$(this).attr("name");a=a.find("td").filter(function(){return $(this).attr("name")===
b}).addClass("column-selected");if(0<a.length)for(var d=a.slice().sort(function(a,b){var d=parseInt($.text([$(a).find("span")]));isNaN(d)&&(d=1E5);var e=parseInt($.text([$(b).find("span")]));isNaN(e)&&(e=1E5);return d-e}),c=a[0].parentNode.parentNode,d=d.map(function(){return this.parentNode.cloneNode(!0)}),h=0;h<d.length;h++)$(d[h]).find("td.row-position").text($(d[h]).find("td.column-selected span").text()),c.insertBefore(d[h],a[h].parentNode),c.removeChild(a[h].parentNode)})},error:function(a,
b,c){$(".competition_results").html("<div class='alert alert-error'>An error occurred. Please try refreshing the page.</div>")}})};c.registationCanProceed=function(){!0===$("#checkbox").is(":checked")?$("#participateButton").removeClass("disabledStatus"):$("#participateButton").addClass("disabledStatus")};c.displayRegistrationStatus=function(b){var a="";$.ajax({type:"GET",url:"/api/competition/"+b+"/mystatus/",cache:!1,success:function(b){console.log(b);"approved"==b.status?location.reload():"pending"==
b.status?(a="<div class='participateInfoBlock pendingApproval'>",a+="<div class='infoStatusBar'></div>",a+="<div class='labelArea'>",a+="<label class='regApprovLabel'>Your request to participate in this challenge has been received and a decision is pending.</label>",a+="<label></label>",a+="</div>",a+="</div>"):"denied"==b.status&&(a="<div class='participateInfoBlock'>",a+="<div class='infoStatusBar'></div>",a+="<div class='labelArea'>",a+="<label class='regDeniedLabel'>Your request to participate in this challenge has been denied. The reason for your denied registrations is: "+
b.reason+"</label>",a+="<label></label>",a+="</div>",a+="</div>");location.reload()},error:function(a,b,c){$(".competition_results").html("<div class='alert - error'>An error occurred. Please try refreshing the page.</div>")}});return a};c.displayNewSubmission=function(b,a,d,e,f,h,g,l,m){var k=$("#submission_details_template #submission_row_template tr").clone();$(k).attr("id",b.id.toString());$(k).addClass(c.oddOrEven(b.submission_number));void 0!==a&&""!==a&&$(k).attr("data-description",a);void 0!==
d&&""!==d&&$(k).attr("data-method-name",d);void 0!==e&&""!==e&&$(k).attr("data-method-description",e);void 0!==f&&""!==f&&$(k).attr("data-project-url",f);void 0!==h&&""!==h&&$(k).attr("data-publication-url",h);void 0!==g&&""!==g&&$(k).attr("data-bibtex",g);void 0!==l&&""!==l&&$(k).attr("data-team-name",l);void 0!==m&&""!==m&&$(k).attr("data-organization-or-affiliation",m);$(k).children().each(function(a){switch(a){case 0:"finished"===b.status&&($(this).val("1"),0<$("#forced_to_leaderboard").length&&
($(".glyphicon-ok").remove(),$($(k).children("td")[4]).html('<span class="glyphicon glyphicon-ok"></span>')));break;case 1:$(this).html(b.submission_number.toString());break;case 2:$(this).html(b.filename);break;case 3:var d=function(a){a=a.toString();1==a.length&&(a="0"+a);return a},e=new Date(b.submitted_at);a=("0"+(e.getMonth()+1).toString()).slice(-2)+"/"+e.getDate().toString()+"/"+e.getFullYear();var f=("0"+e.getHours().toString()).slice(-2),h=d(e.getMinutes()),d=d(e.getSeconds());$(this).html(a+
" "+f+":"+h+":"+d);break;case 4:$(this).html(c.getSubmissionStatus(b.status))}});return k};c.oddOrEven=function(b){return b&1?"odd":"even"};c.getSubmissionStatus=function(b){var a="Unknown";"submitting"===b?a="Submitting":"submitted"===b?a="Submitted":"running"===b?a="Running":"failed"===b?a="Failed":"cancelled"===b?a="Cancelled":"finished"===b&&(a="Finished");return a};c.toggleSubmissionPublic=function(b){b.preventDefault();this.blur();b=$(this).attr("submission-id");var a=$(this);$.get("/my/competition/submission/"+
b+"/toggle_make_public").success(function(b){a.html("Make your submission "+("True"==b?"private":"public"))}).error(function(){alert("Error making submission public, is your Internet connection working?")});return!1};c.updateSubmissionDescription=function(b){b.preventDefault();var a=this;a.blur();b=$(this).attr("submission-id");var d=$(this).parent().find('textarea[name="updated_description"]').val()||"",d=d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");$.post("/competitions/update_description/"+
b,{updated_description:d}).success(function(){$(a).parent().find(".submission_description").html("<b>Description:</b> <br><pre>"+d+"</pre>");$(a).parent().find('textarea[name="updated_description"]').val("").hide();$(a).parent().find(".update_description_btn").removeClass("hide").show();$(a).hide()}).error(function(){alert("Error updating description, is your Internet connection working?")})};c.showOrHideSubmissionDetails=function(b){var a=$(b).parents("tr")[0];if($(b).hasClass("glyphicon-minus"))$(b).removeClass("glyphicon-minus"),
$(b).addClass("glyphicon-plus"),$(a).next("tr.trDetails").remove();else{$(b).removeClass("glyphicon-plus");$(b).addClass("glyphicon-minus");b=$("#submission_details_template .trDetails").clone();b.find(".tdDetails").attr("colspan",a.cells.length);b.find("a").each(function(b){$(this).attr("href",$(this).attr("href").replace("_",a.id))});void 0!==$(a).attr("data-description")&&b.find(".submission_description").html("<b>Description:</b> <br><pre>"+$(a).attr("data-description")+"</pre>");$(a).attr("data-team-name")&&
b.find(".submission_team_name").html("<b>Team name:</b> "+$(a).attr("data-team-name"));$(a).attr("data-method-name")&&b.find(".submission_method_name").html("<b>Method name:</b> "+$(a).attr("data-method-name"));$(a).attr("data-method-description")&&b.find(".submission_method_description").html("<b>Method description:</b><br><pre>"+$(a).attr("data-method-description")+"</pre>");$(a).attr("data-project-url")&&b.find(".submission_project_url").html('<b>Project URL:</b> <a href="'+$(a).attr("data-project-url")+
'">'+$(a).attr("data-project-url")+"</a>");$(a).attr("data-publication-url")&&b.find(".submission_publication_url").html('<b>Publication URL:</b> <a href="'+$(a).attr("data-publication-url")+'">'+$(a).attr("data-publication-url")+"</a>");$(a).attr("data-bibtex")&&b.find(".submission_bibtex").html("<b>Bibtex:</b><br><pre>"+$(a).attr("data-bibtex")+"</pre>");$(a).attr("data-organization-or-affiliation")&&b.find(".submission_organization_or_affiliation").html("<b>Organization/affiliation:</b> "+$(a).attr("data-organization-or-affiliation"));
$(a).attr("data-exception")&&b.find(".traceback").html("Error: <br><pre>"+$(a).attr("data-exception")+"</pre>");var d=$(a).attr("data-is-public")?"private":"public";b.find(".public_link").html("Make your submission "+d);b.find(".public_link").click(c.toggleSubmissionPublic);b.find(".public_link").attr("submission-id",a.id);b.find(".save_description_btn").click(c.updateSubmissionDescription);b.find(".save_description_btn").attr("submission-id",a.id);b.find(".update_description_btn").click(function(){var a=
$(this).parent().find(".submission_description").text(),a=-1!==a.indexOf("Description: ")?a.substr(13):"";$(this).parent().find(".save_description_btn").removeClass("hide").show();$(this).parent().find('textarea[name="updated_description"]').removeClass("hide").show().val(a);$(this).hide()});var d=$("#phasestate").val(),e=$(a).find("input[name='state']").val();if(1==d&&1==e){var f=b.find(".leaderboard_button");f.removeClass("hide");var d=$(a).find(".status").hasClass("submitted"),s=$("#competitionId").val();
g(f,d);f.on("click",function(){h(s,a.id,$("#cstoken").val(),f)})}else{d=$.trim($(a).find(".statusName").html());f=b.find(".leaderboard_button").addClass("hide");if("Submitting"===d||"Submitted"===d||"Running"===d)f.removeClass("hide"),f.text("Refresh status"),f.on("click",function(){c.updateSubmissionStatus($("#competitionId").val(),a.id,this)});"Failed"!==d&&"Cancelled"!==d||b.find("a").removeClass("hide")}$(a).after(b)}};c.updateSubmissionStatus=function(b,a,d){$(d).parents(".submission_details").find(".preloader-handler").append("<div class='competitionPreloader'></div>").children().css({top:"25px",
display:"block"});$.ajax({type:"GET",url:"/api/competition/"+b+"/submission/"+a,cache:!1,success:function(e){$("#user_results #"+a).find(".statusName").html(c.getSubmissionStatus(e.status));if("finished"===e.status)$("#user_results #"+a+"input:hidden").val("1"),1==$("#phasestate").val()?(0<$("#disallow_leaderboard_modifying").length?($(d).text("Leaderboard modifying disallowed").attr("disabled","disabled"),0<$("#forced_to_leaderboard").length&&($(".glyphicon-ok").remove(),$($("#"+a+" td")[4]).html('<span class="glyphicon glyphicon-ok"></span>'))):
0==$("#forced_to_leaderboard").length?($(d).addClass("leaderBoardSubmit"),$(d).text("Submit to Leaderboard")):($(".glyphicon-ok").remove(),$($("#"+a+" td")[4]).html('<span class="glyphicon glyphicon-ok"></span>'),$(d).removeClass("leaderBoardSubmit"),$(d).addClass("leaderBoardRemove"),$(d).text("Remove from Leaderboard")),$(d).unbind("click").off("click").on("click",function(){h(b,a,$("#cstoken").val(),$(d))})):$(d).addClass("hide");else if("failed"===e.status||"cancelled"===e.status)$(d).addClass("hide"),
$(d).parent().parent().find("a").removeClass("hide"),e.exception_details&&$('a[href="traceback/'+a+'/"]').parent().html("Error: <br><pre>"+e.exception_details+"</pre>");$(".competitionPreloader").hide()},error:function(a,b,d){}})};c.initialize=function(){$(document).ready(function(){$("#participate_form").submit(function(b){b.preventDefault();if($("#participateButton").hasClass("disabledStatus"))return!1;$("#result").html("");b=$(this).serialize();var a=$("#competitionId").val();request=$.ajax({url:"/api/competition/"+
a+"/participate/",type:"post",dataType:"text",data:b,success:function(b,e,f){$(".content form").replaceWith(c.displayRegistrationStatus(a))},error:function(a,b,c){alert("There was a problem registering for this competition.")}});return!1});$("#submissions_phase_buttons .btn").each(function(b,a){$(this).click(function(){var a=$.trim($(this).attr("id").replace("submissions_phase_",""));$("#submissions_phase_buttons .btn").removeClass("selected");$(this).addClass("selected");var b=$("#competitionId").val(),
f=$("#cstoken").val();c.getPhaseSubmissions(b,a,f)})});$("#results_phase_buttons .btn").each(function(b,a){$(this).click(function(){var a=$.trim($(this).attr("id").replace("results_phase_",""));$("#results_phase_buttons .btn").removeClass("selected");$(this).addClass("selected");var b=$("#competitionId").val();c.getPhaseResults(b,a)})});$(".top-bar-section ul > li").removeClass("active");$("#liCompetitions").addClass("active");$("#competition-publish-button").click(function(b){b.preventDefault();
var a=$(this).parent()[0];request=$.ajax({url:$(this).attr("href"),success:function(b,e,c){console.log("Published competition.");$(a).children("#competition-publish-button").hide();$(a).children("#competition-delete-button").hide();$(a).children("#competition-unpublish-button").show()},error:function(a,b,c){a=$.parseJSON(a.responseJSON);a.error&&alert(a.error);console.log("Error publishing competition!")}})});$("#competition-unpublish-button").click(function(b){b.preventDefault();var a=$(this).parent()[0];
request=$.ajax({url:$(this).attr("href"),success:function(b,c,f){console.log("Unpublished competition.");$(a).children("#competition-publish-button").show();$(a).children("#competition-delete-button").show();$(a).children("#competition-unpublish-button").hide()},error:function(a,b,c){console.log("Error unpublishing competition!")}})});$("#my_managing .competition-tile .competition-actions").each(function(b,a){"True"==$(this)[0].getAttribute("published")?($(this).find("#competition-delete-button").hide(),
$(this).find("#competition-publish-button").hide(),$(this).find("#competition-unpublish-button").show()):($(this).find("#competition-delete-button").show(),$(this).find("#competition-publish-button").show(),$(this).find("#competition-unpublish-button").hide())})})}})(Competition||(Competition={}));var csrftoken;function csrfSafeMethod(c){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(c)}function sameOrigin(c){var g="//"+document.location.host,h=document.location.protocol+g;return c==h||c.slice(0,h.length+1)==h+"/"||c==g||c.slice(0,g.length+1)==g+"/"||!/^(\/\/|http:|https:).*/.test(c)}$(function(){csrftoken=$.cookie("csrftoken");$.ajaxSetup({beforeSend:function(c,g){!csrfSafeMethod(g.type)&&sameOrigin(g.url)&&c.setRequestHeader("X-CSRFToken",csrftoken)}})});var CodaLab;
(function(c){var g=function(){function c(b){var a=this;this.defaultOptions={buttonId:"fileUploadButton",disabledClassName:"disabled",validateBeforeFilePrompt:function(){return!0},beforeSelection:function(){},afterSelection:function(a,b){},uploadProgress:function(a,b,d){},uploadSuccess:function(a){},uploadError:function(a){},allowedFileTypes:void 0,extensionToFileType:{zip:"application/zip"},maxFileSizeInBytes:void 0,maxBlockSizeInBytes:1048576};this.options=$.extend({},this.defaultOptions,b);var d=
$("#"+this.options.buttonId);this.setupFileInput();d.after(this.fileInput);d.on("click",function(b){d.hasClass(a.options.disabledClassName)||(a.options.validateBeforeFilePrompt()?a.fileInput.click():alert("Please fill in all required fields first!"))})}c.prototype.setupFileInput=function(){var b=this,a=this.fileInput;this.fileInput=$(document.createElement("input"));this.fileInput.attr("type","file");this.fileInput.attr("style","visibility: hidden; width: 1px; height: 1px;");this.fileInput.on("change",
function(a){b.options.beforeSelection();a=b.validate();var e=0<a.files.length&&!0===c.selectionIsValid(a);b.options.afterSelection(a,e);e?b.beginUpload(a,0):b.setupFileInput()});void 0!==a&&a.replaceWith(this.fileInput)};c.prototype.validate=function(){var b=this,a=this.fileInput.get(0).files,d=[];0<a.length&&$.each(a,function(a,c){var h=[];b.options.maxFileSizeInBytes&&c.size>b.options.maxFileSizeInBytes&&h.push({kind:"size-error"});var g=c.type;if(""===g){var l=c.name.split(".");1<l.length&&(g=
b.options.extensionToFileType[l.pop().toLowerCase()])}b.options.allowedFileTypes&&-1===$.inArray(g,b.options.allowedFileTypes)&&h.push({kind:"type-error"});d.push({file:c,errors:h})});return{files:d}};c.selectionIsValid=function(b){return 0===b.files.map(function(a){return a.errors.length}).reduce(function(a,b,c,f){return a+b},0)};c.prototype.getCurrentFile=function(){if(void 0!==this.state)return this.state.selection.files[this.state.fileIndex].file};c.prototype.getFileReader=function(){var b=this,
a=new FileReader;a.onload=function(a){var c=b.state.sasUrl+"&comp=block&blockid="+b.state.blockIds[b.state.blockIds.length-1];a=new Uint8Array(a.target.result);var f=b.state.sasVersion;$.ajax({url:c,type:"PUT",data:a,processData:!1,beforeSend:function(a){a.setRequestHeader("x-ms-version",f);a.setRequestHeader("x-ms-blob-type","BlockBlob")},success:function(a,d){var c=b.getCurrentFile();b.options.uploadProgress(c,b.state.bytesUploaded,c.size);b.state.bytesUploaded<c.size?b.upload():b.endUpload()},
error:function(a,d,c){b.options.uploadError({kind:"write-error",jqXHR:a,file:b.getCurrentFile()})}})};a.onerror=function(a){b.options.uploadError({kind:"read-error",message:a.message,file:b.getCurrentFile()})};return a};c.prototype.beginUpload=function(b,a){this.state={sasUrl:void 0,sasVersion:void 0,trackingId:void 0,reader:void 0,selection:b,fileIndex:a,blockIds:[],bytesUploaded:0};var d=this.getCurrentFile(),c=this;$.ajax({url:c.options.sasEndpoint,type:"POST",data:{name:d.name,type:d.type,size:d.size},
success:function(a,b){c.state.sasUrl=a.url;c.state.sasVersion=a.version;c.state.trackingId=a.id;c.state.reader=c.getFileReader();c.options.uploadProgress(d,c.state.bytesUploaded,d.size);c.upload()},error:function(a,b,d){c.options.uploadError({kind:"sas-error",jqXHR:a,file:c.getCurrentFile()})}})};c.prototype.upload=function(){var b=this.getCurrentFile(),a=this.state.bytesUploaded,c=a+Math.min(b.size-a,this.options.maxBlockSizeInBytes),b=b.slice(a,c),a="000000"+(this.state.blockIds.length+1),a=btoa(a.substring(a.length-
6));this.state.blockIds.push(a);this.state.bytesUploaded=c;this.state.reader.readAsArrayBuffer(b)};c.prototype.endUpload=function(){var b=this.state.sasUrl+"&comp=blocklist",a=this.getCurrentFile(),c=['<?xml version="1.0" encoding="utf-8"?>'];c.push("<BlockList>");for(var e=0;e<this.state.blockIds.length;e++)c.push("  <Latest>"+this.state.blockIds[e]+"</Latest>");c.push("</BlockList>");var f=this;$.ajax({url:b,type:"PUT",contentType:"application/xml",processData:!1,data:c.join("\n"),beforeSend:function(b){b.setRequestHeader("x-ms-version",
f.state.sasVersion);b.setRequestHeader("x-ms-blob-content-type",a.type);b.setRequestHeader("x-ms-meta-name",a.name);b.setRequestHeader("x-ms-meta-size",a.size.toString())},success:function(b,c){f.options.uploadSuccess(a,f.state.trackingId);var d=1+f.state.fileIndex;d<f.state.selection.files.length?f.beginUpload(f.state.selection,d):f.setupFileInput()},error:function(a,b,c){f.options.uploadError({kind:"write-error",jqXHR:a,file:f.getCurrentFile()})}})};c.isSupported=function(){return window.File&&
window.FileReader&&window.FileList&&window.Blob?!0:!1};return c}();c.FileUploader=g;(function(c){c.CreateReady=function(){!1===g.isSupported()?($("#uploadButton").addClass("disabled"),$("#details").html("Sorry, your browser does not support the HTML5 File API. Please use a newer browser.")):new g({buttonId:"uploadButton",sasEndpoint:"/api/competition/create/sas",allowedFileTypes:["application/zip","application/x-zip-compressed"],maxFileSizeInBytes:1073741824,beforeSelection:function(b,a){$("#uploadButton").addClass("disabled")},
afterSelection:function(b,a){!1===a&&(0<b.files.length&&("type-error"===b.files[0].errors[0].kind?$("#details").html('<div class="alert alert-error">Please select a valid file. Only ZIP files are accepted.</div>'):$("#details").html('<div class="alert alert-error">The files that you selected is too large. There is a 1GB size limit.</div>')),$("#uploadButton").removeClass("disabled"))},uploadProgress:function(b,a,c){a=(100*a/c).toFixed(0);$("#details").html('<div class="alert alert-info">Uploading file <strong>'+
b.name+"</strong>: "+a+'% complete.</div><div class="progress"><div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="'+a+'" aria-valuemin="0" aria-valuemax="100" style="width: '+a+'%"></div></div>')},uploadError:function(b){$("#details").html('<div class="alert alert-error">There was an error uploading the file. Please try again.</div>');$("#uploadButton").removeClass("disabled")},uploadSuccess:function(b,a){$("#details").html('<div class="alert alert-info alert-waiting">Creating competition... This may take a while. Please be patient.</div>');
$.ajax({url:"/api/competition/create",type:"post",cache:!1,data:{id:a,name:b.name,type:b.type,size:b.size}}).done(function(a){var b=function(){$.ajax({url:"/api/competition/create/"+a.token,type:"get",cache:!1,data:{csrfmiddlewaretoken:$("input[name='csrfmiddlewaretoken']").val()}}).done(function(a){"finished"==a.status?($("#details").html("Congratulations! Your new competition is ready to <a href='/competitions/"+a.id+"'>view</a>. You can also manage it from <a href='/my/#manage'>your CodaLab dashboard.</a>"),
$("#uploadButton").removeClass("disabled")):"failed"==a.status?($("#details").html('<div class="alert alert-error">Oops! There was a problem creating the competition: <br><pre>'+a.error+"</pre></div>"),$("#uploadButton").removeClass("disabled")):setTimeout(b,1E3)}).fail(function(){$("#details").html('<div class="alert alert-error">An unexpected error occurred.</div>');$("#uploadButton").removeClass("disabled")})};b()}).fail(function(){$("#details").html('<div class="alert alert-error">An unexpected error occurred.</div>');
$("#uploadButton").removeClass("disabled")})}})}})(c.Competitions||(c.Competitions={}))})(CodaLab||(CodaLab={}));//# sourceMappingURL=/static/codalab.min.map
